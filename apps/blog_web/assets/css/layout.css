@layer base {
  html {
    /* Fix for mobile browsers with dynamic URL bars */
    min-height: 100dvh;
  }

  body {
    /* NOTE: Layout dimensions
     * --content-max: 80ch (optimal reading width for prose)
     * --aside-width: 32ch (fits "### Working on Something Cool" without wrapping)
     * 
     * Responsive breakpoint: 100ch
     * Below this threshold, aside is hidden for mobile/narrow viewports.
     */
    --content-max: 80ch;
    --aside-width: 32ch;
    
    display: grid;
    grid-template-columns: minmax(0, var(--content-max)) var(--aside-width);
    grid-template-rows: auto 1fr auto;
    grid-template-areas:
      "header ."
      "content aside"
      "footer .";
    gap: 0 var(--space-4);
    max-inline-size: calc(var(--content-max) + var(--aside-width) + var(--space-4));
    margin-inline: auto;
    padding-inline: var(--space-4);
    min-height: 100dvh;
  }

  .page-header {
    grid-area: header;
  }

  .page-content {
    grid-area: content;
  }

  .page-aside {
    grid-area: aside;
    position: sticky;
    top: var(--space-line);
    align-self: start;
    display: flex;
    flex-direction: column;
    gap: var(--space-line);
  }

  .page-footer {
    grid-area: footer;
  }

  /* Hide aside on narrow viewports (< 100ch) */
  @media (max-width: 100ch) {
    body {
      grid-template-columns: minmax(0, 1fr);
      grid-template-areas:
        "header"
        "content"
        "footer";
      max-inline-size: var(--content-max);
    }

    .page-aside {
      display: none;
    }
  }

  /* Reduce padding on mobile (< 50ch) */
  @media (max-width: 50ch) {
    body {
      padding-inline: var(--space-1);
    }

    .page-header {
      margin-inline: calc(var(--space-1) * -1);
      padding-inline: var(--space-1);
    }

    .page-footer {
      margin-inline: calc(var(--space-1) * -1);
      padding-inline: var(--space-1);
    }
  }

  section {
    margin-block-end: var(--space-line-4);

    &:last-child {
      margin-block-end: 0;
    }
  }
}
